{% extends 'base.html' %}
{% load staticfiles %}
{% load materialize %}

{% block content %}
    <div id="map"></div>

    <div id="tools">
    </div>

    <div id="form-overlay" style="left:45;top:0;">
        <center>
            <h4>
                {% if form.instance.pk %}Editar{% else %}Nova{% endif %} Ocorrência
            </h4>
        </center>
        <div id="mc_mover_form" class="mc_mover_form">
            <i class="mdi-action-open-with"></i>
        </div>
        <hr>
        <form method="POST">
            {% csrf_token %}
            {% if form.non_field_errors %}
                <div class="alert alert-block alert-error">
                {% for error in form.non_field_errors %}
                    <p>{{ error }}</p>
                {% endfor %}
                </div>
            {% endif %}
            {{ form.categoria|as_material:"s12" }}
            {{ form.titulo|as_material:"s12" }}
            {{ form.descricao|as_material:"s12" }}
            {{ form.ponto }}
            <button class="btn waves-effect waves-light" type="submit" name="action">
              Salavr Ocorrência
              <i class="mdi-content-send right"></i>
            </button>
        </form>
    </div>
{% endblock content %}

{% block extra_js %}

<script type="text/javascript">
    var geom = '{{ geom }}';
    $(document).ready(function(){
        init();
        load_cidade_geom();
        mapa_cidadao_draw_component(geom, '#tools');

        if(geom){
            geom = wkt.read(geom);
            map.setCenter(geom.geometry.getBounds().getCenterLonLat(), 15);
        }

        $('select').material_select();
        console.log('aaa')
    });

    $(function() {
        $('#mc_mover_form').mover_h('#form-overlay');
        $('#mc_mover_form').mover_v('#form-overlay');
    });
</script>

{% endblock extra_js %}
